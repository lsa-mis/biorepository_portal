<%= render "remote_modal", title: "Add Item to Checkout" do %>
  <div data-controller="preparation">
    <% @item.preparations.each_with_index do |prep, index| %>
      <div class="">
        <div class="card p-4 shadow-sm">
          <% if prep.prep_type.present? %>
            <p><strong>Preparation Type:</strong> <%= prep.prep_type %></p>
          <% end %>
          <% if prep.description.present? %>
            <p><strong>Description:</strong> <%= prep.description %></p>
          <% end %>
          <% if prep.count.present? %>
            <p><strong>Available Amount:</strong> <%= prep.count %></p>
          <% end %>
          <div class="mt-3">
            <h6 class="fw-semibold mb-1">Select Quantity</h6>
          </div>
          <%= form_with(url: checkout_add_path) do |form| %>
            <%= form.hidden_field :id, value: prep.id %>
            <%= form.select :count, options_for_select(1..show_count(prep, @max_number_of_preparations)), class: "form-select w-auto" %>
            <div class="mt-3">
              <%= form.submit "Add to Checkout", class: "btn btn-primary" %>
              <button type="button" class="btn link_to" data-bs-dismiss="modal" aria-label="Close">Close</button>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>

<% end %>
